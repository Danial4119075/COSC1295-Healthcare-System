<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.*?>

<BorderPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="healthcare.gui.DashboardController">
    <top>
        <VBox BorderPane.alignment="CENTER">
            <children>
                <MenuBar fx:id="menuBar">
                    <menus>
                        <Menu fx:id="patientMenu" mnemonicParsing="false" text="Patients">
                            <items>
                                <MenuItem mnemonicParsing="false" onAction="#handleAddPatient" text="Add New Patient" />
                                <MenuItem fx:id="addPrescriptionMenuItem" mnemonicParsing="false" onAction="#handleAddPrescription" text="Add Prescription" />
                                <MenuItem mnemonicParsing="false" onAction="#handleMovePatient" text="Move Patient" />
                                <!-- ✅ NEW: DISCHARGE PATIENT BUTTON -->
                                <MenuItem mnemonicParsing="false" onAction="#handleDischargePatient" text="Discharge Patient" />
                            </items>
                        </Menu>
                        <Menu fx:id="staffMenu" mnemonicParsing="false" text="Staff">
                            <items>
                                <MenuItem mnemonicParsing="false" onAction="#handleAddStaff" text="Add Staff" />
                            </items>
                        </Menu>
                        <Menu fx:id="shiftMenu" mnemonicParsing="false" text="Shifts">
                            <items>
                                <MenuItem mnemonicParsing="false" onAction="#handleManageShift" text="Manage Shifts" />
                            </items>
                        </Menu>
                        <Menu fx:id="reportMenu" mnemonicParsing="false" text="Reports">
                            <items>
                                <MenuItem mnemonicParsing="false" onAction="#handleViewReports" text="View Reports" />
                                <MenuItem mnemonicParsing="false" onAction="#handleViewAuditLog" text="Audit Log" />
                            </items>
                        </Menu>
                        <Menu mnemonicParsing="false" text="System">
                            <items>
                                <MenuItem mnemonicParsing="false" onAction="#handleLogout" text="Logout" />
                            </items>
                        </Menu>
                    </menus>
                </MenuBar>
                <!-- ═══════════════════════════════════════════════════════════ -->
                <!-- NEW: Added System Clock and Shift Status Section -->
                <!-- ═══════════════════════════════════════════════════════════ -->
                <VBox spacing="5.0" style="-fx-background-color: #f0f0f0; -fx-border-color: #cccccc; -fx-border-width: 0 0 1 0;">
                    <children>
                        <HBox spacing="10.0" alignment="CENTER_LEFT">
                            <children>
                                <Label fx:id="currentStaffLabel" text="Not logged in" style="-fx-font-weight: bold; -fx-font-size: 13px;" />
                                <Separator orientation="VERTICAL" />
                                <Label fx:id="currentShiftLabel" text="Shift Status" style="-fx-font-weight: bold; -fx-font-size: 14px;" />
                            </children>
                        </HBox>
                        <HBox spacing="10.0" alignment="CENTER_LEFT">
                            <children>
                                <Label fx:id="currentTimeLabel" text="⏰ Loading system time..." style="-fx-font-size: 12px; -fx-text-fill: #333333;" />
                                <Region HBox.hgrow="ALWAYS" />
                                <Button fx:id="refreshButton" onAction="#refreshBedDisplay" text="Refresh" />
                            </children>
                        </HBox>
                    </children>
                    <padding>
                        <Insets bottom="8.0" left="10.0" right="10.0" top="8.0" />
                    </padding>
                </VBox>
                <!-- ═══════════════════════════════════════════════════════════ -->
                <!-- END OF NEW SECTION -->
                <!-- ═══════════════════════════════════════════════════════════ -->
            </children>
        </VBox>
    </top>
    <center>
        <SplitPane dividerPositions="0.6" orientation="HORIZONTAL" BorderPane.alignment="CENTER">
            <items>
                <ScrollPane fitToHeight="true" fitToWidth="true">
                    <content>
                        <VBox spacing="10.0">
                            <children>
                                <Label text="Ward Layout" style="-fx-font-size: 16px; -fx-font-weight: bold;" />
                                <GridPane fx:id="bedDisplayGrid" hgap="5.0" vgap="5.0" />
                            </children>
                            <padding>
                                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                            </padding>
                        </VBox>
                    </content>
                </ScrollPane>
                <VBox spacing="10.0">
                    <children>
                        <Label text="Details Panel" style="-fx-font-size: 16px; -fx-font-weight: bold;" />
                        <TextArea fx:id="detailsArea" prefHeight="400.0" wrapText="true" />
                    </children>
                    <padding>
                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                    </padding>
                </VBox>
            </items>
        </SplitPane>
    </center>
    <bottom>
        <Label fx:id="statusLabel" text="Ready" BorderPane.alignment="CENTER">
            <BorderPane.margin>
                <Insets bottom="5.0" left="10.0" right="10.0" top="5.0" />
            </BorderPane.margin>
        </Label>
    </bottom>
</BorderPane>
